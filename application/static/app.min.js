/*!
 * Groceries v0.2.0
 * - - -
 * Copyright (c) 2014 Teun Zengerink
 * Released under MIT lisenced
 * https://raw.github.com/Mytho/groceries/master/LISENCE.md
 */
"use strict";var Groceries=angular.module("Groceries",[]);Groceries.config(["$interpolateProvider",function(a){a.startSymbol("[[").endSymbol("]]")}]),Groceries.factory("itemModel",function(){return function(a){angular.extend(this,{id:null,name:"",bought_by:null,bought_date:null,isBought:function(){return!(!this.bought_by&&!this.bought_date)},update:function(a){angular.extend(this,a)}}),angular.extend(this,a)}}),Groceries.service("itemService",["$http","$log","itemModel",function(a,b,c){var d=function(a){var b,d;for(d=[],b=0;b<a.length;b++)d.push(new c(a[b]));return d};this.deleteItem=function(c){return a.delete("/items/"+c).then(function(a){return a.status=200},function(){b.error("Could not delete item")})},this.toggleItem=function(d,e){return a.put("/items/"+d,{bought:e}).then(function(a){return new c(a.data)},function(){b.error("Could not toggle items")})},this.getGroceries=function(){return a.get("/items").then(function(a){return d(a.data)},function(){b.error("Could not load items")})},this.getSuggestions=function(){return a.get("/suggestions").then(function(a){return d(a.data)},function(){b.error("Could not load suggestions")})}}]),Groceries.controller("listController",["$scope","itemService",function(a,b){a.groceries=[],a.showGroceries=!0,a.showSuggestions=!1,a.suggestions=[],a.visibleButtons=[],a.buttonIsVisible=function(b){return a.visibleButtons.indexOf(b.id)>-1},a.buy=function(a,c){c.stopPropagation(),b.toggleItem(a.id,!a.isBought()).then(function(b){a.update(b)})},a.delete=function(c,d){d.stopPropagation(),b.deleteItem(c.id).then(function(){a.groceries.splice(a.groceries.indexOf(c),1)})},a.toggleButton=function(b){a.visibleButtons.indexOf(b.id)>-1?a.visibleButtons.splice(a.visibleButtons.indexOf(b.id),1):a.visibleButtons.push(b.id)},b.getGroceries().then(function(b){a.groceries=b}),b.getSuggestions().then(function(b){a.suggestions=b})}]);