/*!
 * GROCERIES
 * - - -
 * Author: T. Zengerink (t.zengerink@gmail.com)
 * Copyright (c) 2013 T. Zengerink
 * MIT lisenced, https://raw.github.com/Mytho/groceries/master/LISENCE.md
 */
var $,APP,doc,win,__hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};$=jQuery,doc=document,win=window,APP={Model:{},View:{},Collection:{}},APP.init=function(){return APP.groceryList=new APP.Collection.Grocery,APP.groceryView=new APP.View.Grocery},APP.Model.Item=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.initialize=function(){return this.set("bought",this.get("bought_by")||this.get("bought_date"))},t.prototype.toggle=function(){return this.save({bought:!this.get("bought")})},t}(Backbone.Model),APP.Collection.Grocery=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.model=APP.Model.Item,t.prototype.url="/items",t.prototype.comparator=function(e){return e.get("bought_date")},t}(Backbone.Collection),APP.View.Grocery=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.el=$("div#grocery-list"),t.prototype.events={"keypress input":"createOnEnter"},t.prototype.input=$("input#new-item"),t.prototype.addAll=function(){return APP.groceryList.each(this.addOne,this)},t.prototype.addOne=function(e){var t;return t=new APP.View.Item({model:e}),$(this.el).find("ul").append(t.render().el)},t.prototype.createOnEnter=function(e){if(e.keyCode!==13||this.input.val()==="")return;return APP.groceryList.create({name:this.input.val()}),this.input.val("")},t.prototype.initialize=function(){return this.listenTo(APP.groceryList,"add",this.addOne),this.listenTo(APP.groceryList,"reset",this.addAll),APP.groceryList.fetch()},t}(Backbone.View),APP.View.Item=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.tagName="li",t.prototype.events={swipe:"showDelete","change .bought":"toggleBought","click .delete":"delete"},t.prototype["delete"]=function(){return this.model.destroy()},t.prototype.initialize=function(){return this.template=_.template($("#item-template").html()),this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove)},t.prototype.render=function(){return $(this.el).html(this.template(this.model.toJSON())),$(this.el).find(".delete").hide(),this},t.prototype.showDelete=function(){return $(this.el).find(".delete").toggle()},t.prototype.toggleBought=function(){return this.model.toggle()},t}(Backbone.View);